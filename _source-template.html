<!DOCTYPE html>
<!--
  Bangkok Explorer - Smart Route Planning App
  Copyright Â© 2026 Eitan Fisher. All Rights Reserved.
  
  This application and its source code are protected by copyright.
  Unauthorized copying, distribution, or modification is prohibited.
-->
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Bangkok Explorer ðŸ‡¹ðŸ‡­</title>
    <style>
      @keyframes slideUp {
        from {
          transform: translateY(100px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      
      @keyframes slideDown {
        from {
          transform: translateY(-30px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      
      /* Custom Scrollbar - Thin and Subtle */
      .overflow-y-auto::-webkit-scrollbar {
        width: 6px;
      }
      
      .overflow-y-auto::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
      }
      
      .overflow-y-auto::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
      }
      
      .overflow-y-auto::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }
      
      /* Firefox */
      .overflow-y-auto {
        scrollbar-width: thin;
        scrollbar-color: #cbd5e1 #f1f5f9;
      }
    </style>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK - sequential loading with Promise -->
    <script>
    window.__firebaseReady = new Promise(function(resolve) {
      var libs = ['firebase-app-compat.js','firebase-database-compat.js'];
      var loaded = 0;
      var failed = false;
      
      function loadNext() {
        if (failed || loaded >= libs.length) {
          resolve(!failed);
          return;
        }
        var s = document.createElement('script');
        s.src = 'https://www.gstatic.com/firebasejs/9.22.0/' + libs[loaded];
        s.onload = function() {
          loaded++;
          console.log('[FIREBASE] Loaded: ' + libs[loaded-1]);
          loadNext();
        };
        s.onerror = function() {
          console.warn('[FIREBASE] Blocked: ' + libs[loaded]);
          failed = true;
          resolve(false);
        };
        document.head.appendChild(s);
      }
      
      loadNext();
      
      // Safety timeout - don't wait forever
      setTimeout(function() {
        if (loaded < libs.length && !failed) {
          console.warn('[FIREBASE] Load timeout after 8s');
          resolve(false);
        }
      }, 8000);
    });
    </script>
    
    <!-- Config -->
    <script>
// __INSERT_CONFIG__
    </script>
    <!-- Utils -->
    <script>
// __INSERT_UTILS__
    </script>

    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            borderWidth: {
              '3': '3px',
              '4': '4px',
            }
          }
        }
      }
    </script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
const { useState, useEffect } = React;

// Firebase Configuration - loaded from config.js
const firebaseConfig = window.BKK.firebaseConfig;

// Initialize Firebase (deferred until SDK loads)
let firebaseApp = null;
let database = null;
let isFirebaseAvailable = false;

function initFirebase() {
  try {
    if (typeof firebase !== 'undefined') {
      firebaseApp = firebase.initializeApp(firebaseConfig);
      database = firebase.database();
      isFirebaseAvailable = true;
      console.log('[FIREBASE] Initialized successfully');
    } else {
      console.log('[FIREBASE] Not available - using localStorage only');
    }
  } catch (error) {
    console.error('[FIREBASE] Initialization failed:', error);
    console.log('[FIREBASE] Falling back to localStorage');
  }
}

// Google Places API - loaded from config.js
const GOOGLE_PLACES_API_KEY = window.BKK.GOOGLE_PLACES_API_KEY;
const GOOGLE_PLACES_API_URL = window.BKK.GOOGLE_PLACES_API_URL;

const BangkokExplorer = () => {

// __INSERT_APP_LOGIC__

// __INSERT_VIEWS__

// __INSERT_DIALOGS__


      {/* Debug Panel - Fixed at bottom */}
      {debugMode && (
        <div 
          style={{
            position: 'fixed',
            bottom: 0,
            left: 0,
            right: 0,
            backgroundColor: '#1e293b',
            color: '#e2e8f0',
            zIndex: 9998,
            direction: 'ltr',
            fontFamily: 'monospace',
            fontSize: '11px'
          }}
        >
          {/* Header */}
          <div 
            style={{
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center',
              padding: '6px 12px',
              backgroundColor: '#334155',
              cursor: 'pointer'
            }}
            onClick={() => setDebugPanelOpen(!debugPanelOpen)}
          >
            <span style={{ fontWeight: 'bold' }}>
              ðŸ”§ Debug Log ({debugLogs.length})
            </span>
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                onClick={(e) => {
                  e.stopPropagation();
                  const text = debugLogs.map(l => `${l.timestamp} [${l.category}] ${l.message}${l.data ? ' ' + JSON.stringify(l.data) : ''}`).join('\n');
                  navigator.clipboard.writeText(text);
                  showToast('Copied to clipboard', 'success');
                }}
                style={{
                  padding: '2px 8px',
                  backgroundColor: '#3b82f6',
                  border: 'none',
                  borderRadius: '4px',
                  color: 'white',
                  cursor: 'pointer',
                  fontSize: '10px'
                }}
              >
                Copy
              </button>
              <button
                onClick={(e) => {
                  e.stopPropagation();
                  setDebugLogs([]);
                }}
                style={{
                  padding: '2px 8px',
                  backgroundColor: '#ef4444',
                  border: 'none',
                  borderRadius: '4px',
                  color: 'white',
                  cursor: 'pointer',
                  fontSize: '10px'
                }}
              >
                Clear
              </button>
              <span style={{ fontSize: '14px' }}>
                {debugPanelOpen ? 'â–¼' : 'â–²'}
              </span>
            </div>
          </div>
          
          {/* Log content */}
          {debugPanelOpen && (
            <div 
              style={{
                maxHeight: '150px',
                overflowY: 'auto',
                padding: '8px 12px'
              }}
            >
              {debugLogs.length === 0 ? (
                <div style={{ color: '#94a3b8', textAlign: 'center', padding: '20px' }}>
                  No logs yet. Actions will appear here.
                </div>
              ) : (
                debugLogs.map((log, i) => (
                  <div 
                    key={i}
                    style={{
                      padding: '2px 0',
                      borderBottom: '1px solid #334155',
                      display: 'flex',
                      gap: '8px'
                    }}
                  >
                    <span style={{ color: '#64748b' }}>{log.timestamp}</span>
                    <span style={{ 
                      color: log.category === 'ERROR' ? '#f87171' : 
                             log.category === 'API' ? '#60a5fa' :
                             log.category === 'ROUTE' ? '#4ade80' :
                             log.category === 'ADD' ? '#a78bfa' :
                             '#94a3b8',
                      fontWeight: 'bold',
                      minWidth: '50px'
                    }}>
                      [{log.category}]
                    </span>
                    <span style={{ color: '#e2e8f0' }}>{log.message}</span>
                    {log.data && (
                      <span style={{ color: '#94a3b8', fontSize: '10px' }}>
                        {typeof log.data === 'object' ? JSON.stringify(log.data) : log.data}
                      </span>
                    )}
                  </div>
                ))
              )}
            </div>
          )}
        </div>
      )}


      </div>
    </div>
  );
};

// Wait for Firebase SDK, then init and render
window.__firebaseReady.then(function(sdkLoaded) {
  if (sdkLoaded) {
    initFirebase();
  } else {
    console.log('[FIREBASE] SDK not loaded - running without Firebase');
  }
  ReactDOM.createRoot(document.getElementById('root')).render(<BangkokExplorer />);
});
    </script>
</body>
</html>
